<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Paul's Notes</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../assets/bootstrap/css/bootstrap.min.css">
    <!-- Our Custom CSS -->
    <link rel="stylesheet" href="../assets/scss/style.css">
    <link rel="stylesheet" href="../assets/prism/css/prism.css">
    <link rel="stylesheet" href="../assets/css/navbar-fixed-left.css">

    <!-- Font Awesome JS -->
    <script src="https://kit.fontawesome.com/965bb74516.js" crossorigin="anonymous"></script>
    <script src="../assets/prism/js/prism.js"></script>
</head>

<body>
<div class="wrapper">
    <!-- Sidebar  -->

    <nav id="sidebar" class="navbar fixed-left">
        <ul class="list-unstyled components">
            <li>
                <h4><a href="../">
                    <div class="d-lg-none"><i class="fas fa-home"></i></div>
                    <div class="d-none d-lg-block"><i class="fas fa-home"></i> Home</div>
                </a></h4>
            </li>
            <li>
                <h4><a href="https://www.linkedin.com/in/apaulngo/" target="_blank">
                    <div class="d-lg-none"><i class="fab fa-linkedin"></i></div>
                    <div class="d-none d-lg-block"><i class="fab fa-linkedin"></i> LinkedIn
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"/>
                            <path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"/>
                        </svg>
                    </div>
                </a></h4>
            </li>
            <li>
                <h4><a href="https://github.com/ngopaul/" target="_blank">
                    <div class="d-lg-none"><i class="fab fa-github"></i></div>
                    <div class="d-none d-lg-block"><i class="fab fa-github"></i> Github
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"/>
                            <path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"/>
                        </svg>
                    </div>
                </a></h4>
            </li>
            <li>
                <h4><a href="https://scholar.google.com/citations?user=9woxtpEAAAAJ/" target="_blank">
                    <div class="d-lg-none d-inline"><i class="fas fa-graduation-cap"></i></div>
                    <div class="d-none d-lg-block d-inline"><i class="fas fa-graduation-cap"></i> Scholar
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"/>
                            <path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"/>
                        </svg>
                    </div>
                </a></h4>
            </li>
            <li>
                <h4><a href="https://orcid.org/0000-0003-0187-3551" target="_blank">
                    <div class="d-lg-none d-inline"><img src="../assets/images/ORCIDiD_icon16x16.png" alt="ORCID iD icon"/></div>
                    <div class="d-none d-lg-block d-inline"><img src="../assets/images/ORCIDiD_icon16x16.png" alt="ORCID iD icon"/> ORCID
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"/>
                            <path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z"/>
                        </svg>
                    </div>
                </a></h4>
            </li>
            <li>
                <h4><a href="mailto:paulngo123@gmail.com">
                    <div class="d-lg-none"><i class="fas fa-envelope"></i></div>
                    <div class="d-none d-lg-block"><i class="fas fa-envelope"></i> Email
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-envelope-at" viewBox="0 0 16 16">
                            <path d="M2 2a2 2 0 0 0-2 2v8.01A2 2 0 0 0 2 14h5.5a.5.5 0 0 0 0-1H2a1 1 0 0 1-.966-.741l5.64-3.471L8 9.583l7-4.2V8.5a.5.5 0 0 0 1 0V4a2 2 0 0 0-2-2H2Zm3.708 6.208L1 11.105V5.383l4.708 2.825ZM1 4.217V4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v.217l-7 4.2-7-4.2Z"/>
                            <path d="M14.247 14.269c1.01 0 1.587-.857 1.587-2.025v-.21C15.834 10.43 14.64 9 12.52 9h-.035C10.42 9 9 10.36 9 12.432v.214C9 14.82 10.438 16 12.358 16h.044c.594 0 1.018-.074 1.237-.175v-.73c-.245.11-.673.18-1.18.18h-.044c-1.334 0-2.571-.788-2.571-2.655v-.157c0-1.657 1.058-2.724 2.64-2.724h.04c1.535 0 2.484 1.05 2.484 2.326v.118c0 .975-.324 1.39-.639 1.39-.232 0-.41-.148-.41-.42v-2.19h-.906v.569h-.03c-.084-.298-.368-.63-.954-.63-.778 0-1.259.555-1.259 1.4v.528c0 .892.49 1.434 1.26 1.434.471 0 .896-.227 1.014-.643h.043c.118.42.617.648 1.12.648Zm-2.453-1.588v-.227c0-.546.227-.791.573-.791.297 0 .572.192.572.708v.367c0 .573-.253.744-.564.744-.354 0-.581-.215-.581-.8Z"/>
                        </svg>
                    </div>
                </a></h4>
            </li>
            <li>
                <h4>
                    <a data-bs-toggle="collapse" href="#notescollapse" role="button" aria-expanded="true" aria-controls="collapseExample">
                        <div class="d-none d-lg-block"><i class="fas fa-sticky-note"></i> Notes <i class="fas fa-angle-down"></i></div>
                        <div class="d-lg-none"><i class="fas fa-sticky-note"></i> <i class="fas fa-angle-down"></i></div>
                    </a>
                </h4>
            </li>
            <div class="collapse show" id="notescollapse" style="padding-left: 1vw">
                <li>
                    <h6><a href="./01_stockfish_rpi.html">
                        <div class="d-none d-md-block">Stockfish on Raspberry Pi</div>
                        <div class="d-md-none">1</div>
                    </a></h6>
                </li>
                <li>
                    <h6><a href="./02_PN532_rpi.html">
                        <div class="d-none d-md-block">Using the PN532 on Raspberry Pi</div>
                        <div class="d-md-none">2</div>
                    </a></h6>
                </li>
                <li>
                    <h6><a href="./03_adc_hall_rpi.html">
                        <div class="d-none d-md-block">MCP3008 ADC + Raspberry Pi</div>
                        <div class="d-md-none">3</div>
                    </a></h6>
                </li>
            </div>
        </ul>
    </nav>

    <!-- Page Content  -->
    <div id="content" style="max-width: 80vw">
        <div class="container-fluid" style="text-align: left">
            <h1>Using the PN532 with the Raspberry Pi 3 Model B+ (Raspbian OS Lite)</h1>
            <p>Writing and reading NFC tags using the HiLetgo PN532 NFC NXP RFID Module on the Raspberry Pi 3 Model B+
                (Raspbian OS Lite), using the I2C protocol.</p>
            <h3>Required Components</h3>
            <ul>
                <li>
                    HiLetgo PN532 Module<br/>
                    <img src="../assets/images/pn532.jpg"
                         class="img-thumbnail" style="max-height: 30vh; max-width: 75vw"
                         alt="PN532 control board"
                    >
                    <br/><br/>
                </li>
                <li>Writable NFC tags (a tag comes with the PN532 Module)</li><br/>
                <img src="../assets/images/nfc_tags.jpg"
                     class="img-thumbnail" style="max-height: 30vh; max-width: 75vw"
                     alt="PN532 control board"
                >
                <br/><br/>
                <li>Raspberry Pi 3 Model B+ (Raspbian OS Lite)</li><br/>
                <img src="../assets/images/rpi.jpg"
                     class="img-thumbnail" style="max-height: 30vh; max-width: 75vw"
                     alt="PN532 control board"
                >
                <br/><br/>
                <li>Prototyping Wire (Female to Female 2.54mm Jumper Wires)</li><br/>
                <img src="../assets/images/wires.jpg"
                     class="img-thumbnail" style="max-height: 30vh; max-width: 75vw"
                     alt="PN532 control board"
                >
                <br/><br/>
            </ul>
            <h3>Steps</h3>
            <p>
                Connect the PN532 to the Raspberry Pi. GND should connect to GND, VCC connects to 5V, SDA connects to
                GPIO 2 (Data), and SCL connects to GPIO 3 (Clock).
                See <a href="https://pinout.xyz/pinout/i2c" target="_blank" class="link-primary">I2C at Raspberry Pi GPIO Pinout</a> for
                more details.
            </p>
            <p>
                Use <code>sudo raspi-config</code> to enable I2C. This is in Interface Options > I2C. After installing
                i2c-tools and wiring up the PN532, we should see that the PN532 is recognized as an i2c device with an
                address of 0x24.
            </p>
            <pre class="command-line" data-user="YOUR_USER" data-host="raspberrypi" data-output="3-11"><code class="language-shell">sudo apt-get install i2c-tools
sudo i2cdetect -y 1
     0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f
00:                         -- -- -- -- -- -- -- --
10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
20: -- -- -- -- 24 -- -- -- -- -- -- -- -- -- -- --
30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
70: -- -- -- -- -- -- -- -- </code></pre>
            <p>
                We will use <a href="https://www.kali.org/tools/libnfc/" class="link-primary" target="_blank">libnfc</a>
                in order to read and write NFC tags.
            </p>
            <pre class="command-line" data-user="YOUR_USER" data-host="raspberrypi"><code class="language-shell">sudo apt-get upgrade
sudo apt-get install libusb-dev libnfc6 libnfc-bin libnfc-examples</code></pre>
            <p>Edit <code>/etc/nfc/libnfc.conf</code> to have the following information:</p>
            <pre><code class="language-bash"># Allow device auto-detection (default: true)
# Note: if this auto-detection is disabled, user has to set manually a device
# configuration using file or environment variable
allow_autoscan = true

# Allow intrusive auto-detection (default: false)
# Warning: intrusive auto-detection can seriously disturb other devices
# This option is not recommended, user should prefer to add manually his device.
allow_intrusive_scan = false

# Set log level (default: error)
# Valid log levels are (in order of verbosity): 0 (none), 1 (error), 2 (info), 3 (debug)
# Note: if you compiled with --enable-debug option, the default log level is "debug"
log_level = 1

# Manually set default device (no default)
# To set a default device, you must set both name and connstring for your device
# Note: if autoscan is enabled, default device will be the first device available in device list.
#device.name = "microBuilder.eu"
#device.connstring = "pn532_uart:/dev/ttyUSB0"
device.name = "PN532_I2C"
device.connstring = "pn532_i2c:/dev/i2c-1"</code></pre>
            <p>
                List the connected NFC reader information using <code>nfc-scan-device</code> and then test that it can
                detect an NFC tag by using <code>nfc-poll</code> and holding up the tag to the PN532.
            </p>
            <pre class="command-line" data-user="YOUR_USER" data-host="raspberrypi" data-output="2-8,10-18"><code class="language-shell">nfc-scan-device -v
nfc-scan-device uses libnfc 1.8.0
1 NFC device(s) found:
- PN532_I2C:
    pn532_i2c:/dev/i2c-1
chip: PN532 v1.6
initator mode modulations: ISO/IEC 14443A (424 kbps, 212 kbps, 106 kbps), FeliCa (424 kbps, 212 kbps), ISO/IEC 14443-4B (106 kbps), ISO/IEC 14443-4B' (106 kbps), ISO/IEC 14443-2B ST SRx (106 kbps), ISO/IEC 14443-2B ASK CTx (106 kbps), ISO/IEC 14443-2B-3B iClass (Picopass) (106 kbps), Innovision Jewel (106 kbps), Thinfilm NFC Barcode (106 kbps), D.E.P. (424 kbps, 212 kbps, 106 kbps)
target mode modulations: ISO/IEC 14443A (424 kbps, 212 kbps, 106 kbps), FeliCa (424 kbps, 212 kbps), D.E.P. (424 kbps, 212 kbps, 106 kbps)
nfc-poll
nfc-poll uses libnfc 1.8.0
NFC reader: PN532_I2C opened
NFC device will poll during 36000 ms (20 pollings of 300 ms for 6 modulations)
ISO/IEC 14443A (106 kbps) target:
    ATQA (SENS_RES): 00  04
       UID (NFCID1): 63  6d  b3  98
      SAK (SEL_RES): 08
Waiting for card removing...done.
nfc_initiator_target_is_present: Target Released</code></pre>
            <p>Install dev packages to support pynfc so ctypes can find the relevant packages (libfreefare.so):</p>
            <pre class="command-line" data-user="YOUR_USER" data-host="raspberrypi"><code class="language-shell">sudo apt-get install libfreefare-dev
pip install pynfc</code></pre>
            <br/>
            <h3>References</h3>
            <ul>
                <li><a href="https://blog.stigok.com/2017/10/12/setting-up-a-pn532-nfc-module-on-a-raspberry-pi-using-i2c.html" class="link-primary" target="_blank">
                    Blog of stigok: Setting up a PN532 NFC module on a Raspberry Pi using I2C
                </a></li>
                <li><a href="https://www.kali.org/tools/libnfc/" class="link-primary" target="_blank">
                    kali.org: libnfc
                </a></li>
                <li><a href="https://github.com/nfc-tools/libnfc" class="link-primary" target="_blank">
                    libnfc github
                </a></li>
                <li><a href="https://pinout.xyz/pinout/i2c" class="link-primary" target="_blank">
                    Raspberry Pi Pinout: I2C by @Gagetoid
                </a></li>
            </ul>
        </div>
        <hr/>
    </div>
</div>

<!-- jQuery CDN - Slim version (=without AJAX) -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<!-- Popper.JS -->
<script src="../assets/bootstrap/js/popper.min.js"></script>
<!-- Bootstrap JS -->
<script src="../assets/bootstrap/js/bootstrap.min.js"></script>
<script src="../assets/js/script.js"></script>
</body>

</html>
